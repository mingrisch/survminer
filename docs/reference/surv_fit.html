<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create Survival Curves — surv_fit • survminer</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">survminer</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../survminer_cheatsheet.pdf">Cheatseet</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kassambara/survminer">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create Survival Curves</h1>
    </div>

    
    <p>Wrapper arround the standard <a href='http://www.rdocumentation.org/packages/survival/topics/survfit'>survfit</a>() function to create
  survival curves. Compared to the standard <a href='http://www.rdocumentation.org/packages/survival/topics/survfit'>survfit</a>() function, it supports also:
  <ul>
<li> a list of data sets and/or a list of formulas,
  </li>
<li> a grouped data sets as generated by the function <a href='surv_group_by.html'>surv_group_by</a>,
  </li>
<li> group.by option
  </li>
</ul></p>

    <p>There are many cases, where this function might be useful:
  <ul>
<li> <strong>Case 1: One formula and One data set</strong>.
  Example: You want to fit the survival curves of one biomarker/gene in a given data set.
  This is the same as the standard <a href='http://www.rdocumentation.org/packages/survival/topics/survfit'>survfit</a>() function. Returns one survfit object.
  </li>
<li> <strong>Case 2: List of formulas and One data set</strong>.
  Example: You want to fit the survival curves of a list of biormarkers/genes in the same data set.
  Returns a named list of survfit objects in the same order as formulas.
  </li>
<li> <strong>Case 3: One formula and List of data sets</strong>.
  Example: You want to fit survival curves of one biomarker/gene in multiple cohort of patients (colon, lung, breast).
  Returns a named list of survfit objects in the same order as the data sets.
  </li>
<li> <strong>Case 4: List of formulas and List of data sets</strong>.
  Example: You want to fit survival curves of multiple biomarkers/genes in multiple cohort of patients (colon, lung, breast).
  Each formula will be applied to each of the data set in the data list.
  Returns a named list of survfit objects.
  </li>
<li> <strong>Case 5: One formula and grouped data sets by one or two variables</strong>.
   Example: One might like to plot the survival curves of patients
   treated by drug A vs patients treated by drug B in a dataset grouped by TP53 and/or RAS mutations.
   In this case use the argument <code>group.by</code>. Returns a named list of survfit objects.
  </li>
<li> <strong>Case 6</strong>. In a rare case you might have a list of formulas and a list of data sets, and
  you might want to <strong>apply each formula to the mathcing data set with the same index/position in the list</strong>.
  For example formula1 is applied to data 1, formula2 is applied to data 2, and so on ...
  In this case formula and data lists should have the same length and you should specify the argument match.fd = TRUE ( stands for match formula and data).
  Returns a named list of survfit objects.
  </li>
</ul></p>

    <p>The output of the <code>surv_fit</code>() function can be directly handled by the following functions:</p>

    <p><ul>
<li> <a href='ggsurvplot.html'>ggsurvplot</a>()
  </li>
<li> <a href='surv_pvalue.html'>surv_pvalue</a>()
  </li>
<li> <a href='surv_median.html'>surv_median</a>()
  </li>
</ul></p>

    <p>These functions return one element or a list of elements depending on the format of the input.</p>
    

    <pre><span class='fu'>surv_fit</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>group.by</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>match.fd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>formula</dt>
      <dd>survival formula. See <a href='http://www.rdocumentation.org/packages/survival/topics/survfit.formula'>survfit.formula</a>. Can be a list of formula. Named lists are recommended.</dd>
      <dt>data</dt>
      <dd>a data frame in which to interpret the variables named in the formula.
Can be a list of data sets. Named lists are recommended.
Can be also a grouped dataset as generated by the function <a href='surv_group_by.html'>surv_group_by</a>().</dd>
      <dt>group.by</dt>
      <dd>a grouping variables to group the data set by.
A character vector containing the name of grouping variables. Should be of length &lt;= 2.</dd>
      <dt>match.fd</dt>
      <dd>logical value. Default is FALSE. Stands for &quot;match formula and data&quot;.
Useful only when you have a list of formulas and a list of data sets, and
  you want to apply each formula to the matching data set with the same index/position in the list.
  For example formula1 is applied to data 1, formula2 is applied to data 2, and so on ....
  In this case use match.fd = TRUE.</dd>
      <dt>...</dt>
      <dd>Other arguments passed to the <a href='http://www.rdocumentation.org/packages/survival/topics/survfit.formula'>survfit.formula</a> function.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><ul>
<li> Returns an object of class survfit if one formula and one data set provided.
</li>
<li> Returns a named list of survfit objects when input is a list of formulas and/or data sets.
The same holds true when grouped data sets are provided or when the argument <code>group.by</code> is specified.
<ul>
<li> If the names of formula and data lists are available,
the names of the resulting survfit objects list are obtained by collapsing the names of formula and data lists.
</li>
<li> If the formula names are not available, the variables in the formulas are extracted and used to build the name of survfit object.
</li>
<li> In the case of grouped data sets, the names of survfit object list are obtained by
collapsing the levels of grouping variables and the names of variables in the survival curve formulas.
</li>
</ul></p>
    <p></li>
</ul></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>library</span>(<span class='st'>"survival"</span>)
<span class='fu'>library</span>(<span class='st'>"magrittr"</span>)

<span class='co'># Case 1: One formula and One data set</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>surv_fit</span>(<span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>,
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>)
<span class='fu'><a href='surv_pvalue.html'>surv_pvalue</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.6107936 Log-rank p = 0.61</div><div class='input'>

<span class='co'># Case 2: List of formulas and One data set.</span>
<span class='co'>#   - Different formulas are applied to the same data set</span>
<span class='co'>#   - Returns a (named) list of survfit objects</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='co'># Create a named list of formulas</span>
<span class='no'>formulas</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
 <span class='kw'>sex</span> <span class='kw'>=</span> <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>,
 <span class='kw'>rx</span> <span class='kw'>=</span> <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>rx</span>
)

<span class='co'># Fit survival curves for each formula</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>surv_fit</span>(<span class='no'>formulas</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>)
<span class='fu'><a href='surv_pvalue.html'>surv_pvalue</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $`colon::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.6107936 Log-rank p = 0.61
#&gt; 
#&gt; $`colon::rx`
#&gt;   variable         pval   method   pval.txt
#&gt; 1       rx 4.990735e-08 Log-rank p &lt; 0.0001
#&gt; </div><div class='input'>
<span class='co'># Case 3: One formula and List of data sets</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>surv_fit</span>(<span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>,
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='no'>colon</span>, <span class='no'>lung</span>))
<span class='fu'><a href='surv_pvalue.html'>surv_pvalue</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $`colon::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.6107936 Log-rank p = 0.61
#&gt; 
#&gt; $`lung::sex`
#&gt;   variable        pval   method   pval.txt
#&gt; 1      sex 0.001311165 Log-rank p = 0.0013
#&gt; </div><div class='input'>

<span class='co'># Case 4: List of formulas and List of data sets</span>
<span class='co'>#  - Each formula is applied to each of the data in the data list</span>
<span class='co'>#  - argument: match.fd = FALSE</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>

<span class='co'># Create two data sets</span>
<span class='fu'>set.seed</span>(<span class='fl'>123</span>)
<span class='no'>colon1</span> <span class='kw'>&lt;-</span> <span class='kw'>dplyr</span><span class='kw'>::</span><span class='fu'>sample_frac</span>(<span class='no'>colon</span>, <span class='fl'>1</span>/<span class='fl'>2</span>)
<span class='fu'>set.seed</span>(<span class='fl'>1234</span>)
<span class='no'>colon2</span> <span class='kw'>&lt;-</span> <span class='kw'>dplyr</span><span class='kw'>::</span><span class='fu'>sample_frac</span>(<span class='no'>colon</span>, <span class='fl'>1</span>/<span class='fl'>2</span>)

<span class='co'># Create a named list of formulas</span>
<span class='no'>formula.list</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
 <span class='kw'>sex</span> <span class='kw'>=</span> <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>,
 <span class='kw'>adhere</span> <span class='kw'>=</span> <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>adhere</span>,
 <span class='kw'>rx</span> <span class='kw'>=</span> <span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>rx</span>
)

<span class='co'># Fit survival curves</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>surv_fit</span>(<span class='no'>formula.list</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='no'>colon1</span>, <span class='no'>colon2</span>),
               <span class='kw'>match.fd</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='fu'><a href='surv_pvalue.html'>surv_pvalue</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $`colon1::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.7098588 Log-rank p = 0.71
#&gt; 
#&gt; $`colon2::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.7254968 Log-rank p = 0.73
#&gt; 
#&gt; $`colon1::adhere`
#&gt;   variable         pval   method    pval.txt
#&gt; 1   adhere 0.0002416513 Log-rank p = 0.00024
#&gt; 
#&gt; $`colon2::adhere`
#&gt;   variable        pval   method   pval.txt
#&gt; 1   adhere 0.003468833 Log-rank p = 0.0035
#&gt; 
#&gt; $`colon1::rx`
#&gt;   variable        pval   method   pval.txt
#&gt; 1       rx 0.001421399 Log-rank p = 0.0014
#&gt; 
#&gt; $`colon2::rx`
#&gt;   variable         pval   method   pval.txt
#&gt; 1       rx 8.123231e-06 Log-rank p &lt; 0.0001
#&gt; </div><div class='input'>

<span class='co'># Grouped survfit</span>
<span class='co'>#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</span>
<span class='co'># - Group by the treatment "rx" and fit survival curves on each subset</span>
<span class='co'># - Returns a list of survfit objects</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>surv_fit</span>(<span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>,
               <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>colon</span>, <span class='kw'>group.by</span> <span class='kw'>=</span> <span class='st'>"rx"</span>)

<span class='co'># Alternatively, do this</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='no'>colon</span> <span class='kw'>%&gt;%</span>
 <span class='fu'><a href='surv_group_by.html'>surv_group_by</a></span>(<span class='st'>"rx"</span>) <span class='kw'>%&gt;%</span>
 <span class='fu'>surv_fit</span>(<span class='fu'>Surv</span>(<span class='no'>time</span>, <span class='no'>status</span>) ~ <span class='no'>sex</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>.</span>)

<span class='fu'><a href='surv_pvalue.html'>surv_pvalue</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $`rx.Obs::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.5337304 Log-rank p = 0.53
#&gt; 
#&gt; $`rx.Lev::sex`
#&gt;   variable      pval   method pval.txt
#&gt; 1      sex 0.2928911 Log-rank p = 0.29
#&gt; 
#&gt; $`rx.Lev+5FU::sex`
#&gt;   variable         pval   method    pval.txt
#&gt; 1      sex 0.0005623961 Log-rank p = 0.00056
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alboukadel Kassambara, Marcin Kosinski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
